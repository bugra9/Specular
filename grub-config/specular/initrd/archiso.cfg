if [ -d (loop)/arch/boot ]; then
	set initrdType="archiso"
fi

if [ "x$initrdType" = "xarchiso" ]; then
	if [ -z $linuxFile ]; then
		if cpuid -l; then
			if [ -s (loop)/arch/boot/x86_64/vmlinuz ]; then
				set linuxFile="/arch/boot/x86_64/vmlinuz"
				set initrdFile="/arch/boot/x86_64/archiso.img"
				set intelFile="/arch/boot/intel_ucode.img"
			elif [ -s (loop)/arch/boot/vmlinuz ]; then
				set linuxFile="/arch/boot/vmlinuz"
				set initrdFile="/arch/boot/archiso.img"
				set intelFile="/arch/boot/intel_ucode.img"
			fi
		else
			if [ -s (loop)/arch/boot/i686/vmlinuz ]; then
				set linuxFile="/arch/boot/i686/vmlinuz"
				set initrdFile="/arch/boot/i686/archiso.img"
				set intelFile="/arch/boot/intel_ucode.img"
			fi
		fi
		set grubFile="/boot/grub/loopback.cfg"
		set isolinuxFile="/isolinux/isolinux.cfg"
	fi

	set opt="$opt img_dev=$imgdevpath img_loop=$isofile archisolabel=$isolabel misolabel=$isolabel baslatan_locale=${def_bootlang} baslatan_keyboard=${def_keyboard} baslatan_timezone=${def_timezone} lang=${def_bootlang} keytable=${def_keyboard} layout=${def_keyboard}"

	set opt_integrityCheck="checksum=y"
	set opt_failsafe="${opt_live} nomodeset failsafe driver=free nouveau.modeset=1 i915.modeset=1 radeon.modeset=1"
	set opt_ram="${opt_live} copytoram=y"

	if [ "x$persistentFS" != "xntfs" ]; then
		set opt_filePersistentNew=' '
		set opt_filePersistent='cow_directory="$persistentDir/$isolabelsafe" cow_filename="$filename" cow_device="/dev/disk/by-uuid/$persistentUUID"'
		set opt_filesystemPersistent='cow_directory="$persistentDir/$isolabelsafe/$filename" cow_device="/dev/disk/by-uuid/$persistentUUID"'
	fi

fi